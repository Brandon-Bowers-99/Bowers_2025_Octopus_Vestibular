---
title: "Statistical Analysis"
author: "Brandon Bowers"
date: "2025-03-19"
output: html_document
---
```{r}
 library(nlme)
 library(lme4)
 library(car)
 library(tidyverse)
 library(ggplot2)
library(lattice)
```

```{r}
WD = "C:\\Users\\Bvipe\\OneDrive - Walla Walla University\\Desktop\\Bowers_2025_Octopus_Vestibular"

datelist_u = c("7_24","7_26","7_28","7_30","8_1","8_3","8_5","8_7","8_9","8_11","8_13","8_15","8_17")
```

#Read in Trial-type Log
```{r}
Trial_type_log = read.csv("C:\\Users\\Bvipe\\OneDrive - Walla Walla University\\Desktop\\Bowers_2025_Octopus_Vestibular\\Raw Data\\Trial Type.csv")
```

```{r}
FV_get_file = function(WD,d){ 
  wd = c(WD,"Processed Data","Full Video Results",d)
  wd_path = stringr::str_c(wd, collapse = "/")
  in_files_list = list.files(wd_path, pattern = NULL, all.files = FALSE,
           full.names = FALSE, recursive = FALSE,
           ignore.case = FALSE, include.dirs = FALSE, no.. = FALSE)
  return(in_files_list)
}
```

```{r}
PA_get_file = function(WD){ 
  wd = c(WD,"Processed Data\\Path Analysis Results")
  wd_path = stringr::str_c(wd, collapse = "/")
  in_files_list = list.files(wd_path, pattern = NULL, all.files = FALSE,
           full.names = FALSE, recursive = FALSE,
           ignore.case = FALSE, include.dirs = FALSE, no.. = FALSE)
  return(in_files_list)
}
```

```{r}
FV_get_file_DLC = function(WD,d){ 
  wd = c(WD,"Processed Data","Full Video Results DLC",d)
  wd_path = stringr::str_c(wd, collapse = "/")
  in_files_list = list.files(wd_path, pattern = NULL, all.files = FALSE,
           full.names = FALSE, recursive = FALSE,
           ignore.case = FALSE, include.dirs = FALSE, no.. = FALSE)
  return(in_files_list)
}
```

```{r}
PA_get_file_DLC = function(WD){ 
  wd = c(WD,"Processed Data\\Path Analysis Results DLC")
  wd_path = stringr::str_c(wd, collapse = "/")
  in_files_list = list.files(wd_path, pattern = NULL, all.files = FALSE,
           full.names = FALSE, recursive = FALSE,
           ignore.case = FALSE, include.dirs = FALSE, no.. = FALSE)
  return(in_files_list)
}
```


#Create a table from the the processed data that makes all effects accessible. FULL VID RESULTS
```{r}
Date = c()
OC_ID = c()
Trial_Type = c()
Duration = c()
Avg_Speed_Per_Bodylength = c()
Avg_Bearing_Change = c()
Avg_Bearing_vs_Heading_FV = c()
Average_Change_Bearing_vs_Heading_FV = c()

for (d in datelist_u){
  FV_files = FV_get_file(WD,d)
  for (f in FV_files){
    Date = c(Date,d)
    
    oc = unlist(strsplit(f,".csv"))[1]
    oc = unlist(strsplit(oc,paste0("O")))[2]
    OC_ID = c(OC_ID,oc)
    
    curr_data = read.csv(paste0(WD,"\\Processed Data\\Full Video Results\\",d,"\\",f))
    
    Time_to_crab = read.csv(paste0(WD,"\\Raw Data\\Time_to_crab.csv"))
    for (i in 1:length(Time_to_crab$Date)){
      if (Time_to_crab$Date[i] == d){
        if (as.character(Time_to_crab$OC_ID[i]) == oc){
            Duration = c(Duration,Time_to_crab$Time[i])
        }
      }
    }

    #Find average speed/bodylength and append it to master list
    avg_SPB = sum(curr_data$Speed_per_MI) / length(curr_data$Speed_per_MI)
    Avg_Speed_Per_Bodylength = c(Avg_Speed_Per_Bodylength,avg_SPB)
    
    #Find average bearing change
    avg_BC = sum(curr_data$Bearing_Change) / length(curr_data$Bearing_Change)
    Avg_Bearing_Change = c(Avg_Bearing_Change,avg_BC)
    
    #Find avg bearing vs heading
    avg_BvH = sum(curr_data$Bearing_Move_Diff) / length(curr_data$Bearing_Move_Diff)
    Avg_Bearing_vs_Heading_FV = c(Avg_Bearing_vs_Heading_FV,avg_BvH)
    
    #find avg change in b-h diff
    avg_CBvH = sum(curr_data$Bearing_Heading_Diff_Change) / length(curr_data$Bearing_Heading_Diff_Change)
    Average_Change_Bearing_vs_Heading_FV = c(Average_Change_Bearing_vs_Heading_FV,avg_CBvH)

    for (t in 1:length(Trial_type_log$Trial.Type)){
      if (Trial_type_log$Date[t] == d & as.character(Trial_type_log$OC_ID[t]) == oc){
        Trial_Type = c(Trial_Type,Trial_type_log$Trial.Type[t])
      }
    }
  }
}

dates.ex=strptime(FV_master_set$Date,"%m_%d")
NewDates = difftime(dates.ex,min(dates.ex),units="day")

FV_master_set = data.frame(Date,OC_ID,Trial_Type, Duration, Avg_Speed_Per_Bodylength,Avg_Bearing_Change,Avg_Bearing_vs_Heading_FV,Average_Change_Bearing_vs_Heading_FV)
FV_master_set = data.frame(FV_master_set,NewDates)

write.csv(FV_master_set,paste0(WD,"\\Processed Data\\FV_Master_Set.csv"))
```

#Create a table from the the processed data that makes all effects accessible. PATH ANALYSIS RESULTS
```{r}
PA_files = PA_get_file(WD)
Date = c()
OC_ID = c()
Trial_Type = c()
Movement_Type = c()
Distance_of_Movement = c()
Duration = c()
Speed = c()
Speed_per_Bodylength = c()
Bearing_Change = c()
Avg_Bearing_vs_Heading = c()
Avg_Bearing_vs_Heading_Change = c()
Avg_Directness_Difference = c()

for (fi in PA_files){
  current_data = read.csv(paste0(WD,"\\Processed Data\\Path Analysis Results\\",fi))
  Date = c(Date,current_data$date)
  OC_ID = c(OC_ID,current_data$oc_ID)
  Movement_Type = c(Movement_Type, current_data$movement_type)
  Distance_of_Movement = c(Distance_of_Movement ,current_data$total_movement_dis)
  Duration = c(Duration, current_data$duration)
  Speed = c(Speed,current_data$speed)
  Speed_per_Bodylength = c(Speed_per_Bodylength, current_data$speed_per_bodylength)
  Bearing_Change = c(Bearing_Change, current_data$angle_dev)
  Avg_Bearing_vs_Heading = c(Avg_Bearing_vs_Heading, current_data$avg_bear_head_dif)
  Avg_Bearing_vs_Heading_Change = c(Avg_Bearing_vs_Heading_Change, current_data$avg_bear_head_dif_dif)
  Avg_Directness_Difference = c(Avg_Directness_Difference, current_data$avg_head_vs_crab)
  
  count = 0
  for (t in 1:length(Trial_type_log$Trial.Type)){
    if (Trial_type_log$Date[t] == current_data$date[1]){
      for (l in 1:length(current_data$oc_ID)){
        if (current_data$oc_ID[l] == Trial_type_log$OC_ID[t]){
          Trial_Type = c(Trial_Type,Trial_type_log$Trial.Type[t])
          count = count + 1
        }
      }
    }
  }
}

dates.ex=strptime(PA_master_set$Date,"%m_%d")
NewDates = difftime(dates.ex,min(dates.ex),units="day")

PA_master_set = data.frame(Date,OC_ID,Trial_Type,Movement_Type,Distance_of_Movement,Duration,Speed,Speed_per_Bodylength,Bearing_Change,Avg_Bearing_vs_Heading,Avg_Bearing_vs_Heading_Change,Avg_Directness_Difference)
PA_master_set = data.frame(PA_master_set,NewDates)

write.csv(PA_master_set,paste0(WD,"\\Processed Data\\PA_Master_Set.csv"))
```

#Change radians to degrees
```{r}
for (i in 1:length(FV_master_set$Avg_Bearing_Change)){
  FV_master_set$Avg_Bearing_Change[i] = NISTradianTOdeg(FV_master_set$Avg_Bearing_Change[i])
  FV_master_set$Avg_Bearing_vs_Heading_FV[i] = NISTradianTOdeg(FV_master_set$Avg_Bearing_vs_Heading_FV[i])
  FV_master_set$Average_Change_Bearing_vs_Heading_FV[i] = NISTradianTOdeg(FV_master_set$Average_Change_Bearing_vs_Heading_FV[i])
}

for (j in 1:length(PA_master_set$Bearing_Change)){
  PA_master_set$Bearing_Change[j] = NISTradianTOdeg(PA_master_set$Bearing_Change[j])
  PA_master_set$Avg_Bearing_vs_Heading[j] = NISTradianTOdeg(PA_master_set$Avg_Bearing_vs_Heading[j])
  PA_master_set$Avg_Bearing_vs_Heading_Change[j] = NISTradianTOdeg(PA_master_set$Avg_Bearing_vs_Heading_Change[j])
  PA_master_set$Avg_Directness_Difference[j] = NISTradianTOdeg(PA_master_set$Avg_Directness_Difference[j])
}
```

########
#Run mixed effects model#
########

#Analyzing Path Analysis Data
##############################

#Movment type over time
```{r}
# Using Chi Square test
move.tab=table(PA_master_set$Trial_Type,PA_master_set$Movement_Type)
move.tab
move.chi=chisq.test(move.tab)
move.chi

```


```{r}
PA_master_set$Trial_Type=as.factor(PA_master_set$Trial_Type)
PA_master_set$Movement_Type=as.factor(PA_master_set$Movement_Type)

movement_type.lme = glmer(Movement_Type ~ Trial_Type * NewDates + (1 | OC_ID), data = PA_master_set, family = binomial)

catch.ANOVA=Anova(bearing_change.lme,type="III")
catch.ANOVA
```

# Using Chi Square test
```{r}
move.tab=table(PA_master_set$Trial_Type,PA_master_set$Movement_Type)
move.tab
move.chi=chisq.test(move.tab)
move.chi
```

#Avg Directness Difference (movement type 1)
```{r}
PA_master_set$Trial_Type=as.factor(PA_master_set$Trial_Type)

bearing_change.lme=lme((Avg_Directness_Difference)~Trial_Type*NewDates,random=~1|OC_ID,
                       data=PA_master_set[PA_master_set$Movement_Type==1,])
bearing_change.ANOVA=Anova(bearing_change.lme,type="III")
bearing_change.ANOVA

```
```{r}
unique(PA_master_set$Trial_Type)

predict.data=data.frame(Trial_Type=as.factor(rep(unique(PA_master_set$Trial_Type),2)),NewDates=c(0,0,8,24))

predict.data$predict=predict(bearing_change.lme,newdata = predict.data,level=0)
predicted_data = predict.data

unspun_predy = c(predicted_data$predict[2],predicted_data$predict[4])
spun_predy = c(predicted_data$predict[1],predicted_data$predict[3])
u_dates_pred = c(0,24)
s_dates_pred = c(0,8)

plot(abs(Avg_Directness_Difference)~NewDates,
     data=PA_master_set[PA_master_set$Movement_Type==1&PA_master_set$Trial_Type==4,],
     #log="y",
     ylim=range(-25,65),
     xlim = range(0,25),
     xlab = "Number of days from beggining of trial",
     ylab = "Degrees"
     pch=21,bg="red"
     )
points((Avg_Directness_Difference)~NewDates,
     data=PA_master_set[PA_master_set$Movement_Type==1&PA_master_set$Trial_Type==1,],
     pch=21,bg="blue")

lines(u_dates_pred,unspun_predy)
lines(s_dates_pred,spun_predy)

print(predicted_data)
```

```{r}
PA_DD_SPUN = (PA_master_set$Avg_Directness_Difference[PA_master_set$Movement_Type==1&PA_master_set$Trial_Type==1])
PA_DD_CONTROL = (PA_master_set$Bearing_Change[PA_master_set$Movement_Type==1&PA_master_set$Trial_Type==4])

PA_DD_SPUN_norm <- rnorm(0.25,mean=mean(PA_DD_SPUN, na.rm=TRUE), sd=sd(PA_DD_SPUN, na.rm=TRUE))
PA_DD_CONTROL_norm <- rnorm(0.25,mean=mean(PA_DD_CONTROL, na.rm=TRUE), sd=sd(PA_DD_CONTROL, na.rm=TRUE))

Pltx_DD_CONTROL_1 = c()
Pltx_DD_SPUN_1 = c()
for (i in 1:length(PA_DD_CONTROL)){
  Pltx_DD_CONTROL_1 = c(Pltx_DD_CONTROL_1,1)
}
for (i in 1:length(PA_DD_SPUN)){
  Pltx_DD_SPUN_1 = c(Pltx_DD_SPUN_1,2)
}

for (i in 1:length(Pltx_DD_CONTROL_1)){
  Pltx_DD_CONTROL_1[i] = jitter(Pltx_DD_CONTROL_1[i],factor = 6)
}
for (i in 1:length(Pltx_DD_SPUN_1)){
  Pltx_DD_SPUN_1[i] = jitter(Pltx_DD_SPUN_1[i],factor = 3)
}

PA_DD_1 = boxplot(PA_DD_CONTROL,PA_DD_SPUN,
#main = "Average Directness Difference in Crawling Movements",
ylab = "Degrees",
ylim = range(-150,150),
at = c(1,2),
names = c("Control", "Spun"),
las = 2,
col = c("#C1FFC1","#FFAEB9"),
border = "black",
horizontal = FALSE,
notch = FALSE,
range = 0
)

points(x = Pltx_DD_CONTROL_1 ,y = PA_DD_CONTROL,col="black")
points(x = Pltx_DD_SPUN_1 ,y = PA_DD_SPUN,col="black")

```

```{r}
mean(FV_master_set$Duration[FV_master_set$Trial_Type == "1"])
mean(FV_master_set$Duration[FV_master_set$Trial_Type == "4"])

mean(FV_master_set$Avg_Bearing_vs_Heading_FV[FV_master_set$Trial_Type == "1"])
mean(FV_master_set$Avg_Bearing_vs_Heading_FV[FV_master_set$Trial_Type == "4"])
max(FV_master_set$Duration)
min(FV_master_set$Duration)

mean(FV_master_set$Average_Change_Bearing_vs_Heading_FV[FV_master_set$Trial_Type == "1"])
mean(FV_master_set$Average_Change_Bearing_vs_Heading_FV[FV_master_set$Trial_Type == "4"])

mean(PA_master_set$Avg_Directness_Difference[PA_master_set$Trial_Type == "1"& PA_master_set$Movement_Type == "1"])
mean(PA_master_set$Avg_Directness_Difference[PA_master_set$Trial_Type == "4" & PA_master_set$Movement_Type == "1"])

mean(PA_master_set$Avg_Bearing_vs_Heading_Change[PA_master_set$Trial_Type == "1"& PA_master_set$Movement_Type == "1"])
mean(PA_master_set$Avg_Bearing_vs_Heading_Change[PA_master_set$Trial_Type == "4" & PA_master_set$Movement_Type == "1"])
```

```{r}
mean(PA_master_set$Speed_per_Bodylength[PA_master_set$Trial_Type == "1"& PA_master_set$Movement_Type == "1"])
mean(PA_master_set$Speed_per_Bodylength[PA_master_set$Trial_Type == "4" & PA_master_set$Movement_Type == "1"])

mean(PA_master_set$Avg_Bearing_vs_Heading[PA_master_set$Trial_Type == "1"& PA_master_set$Movement_Type == "1"])
mean(PA_master_set$Avg_Bearing_vs_Heading[PA_master_set$Trial_Type == "4" & PA_master_set$Movement_Type == "1"])

mean(PA_master_set$Duration[PA_master_set$Trial_Type == "1"& PA_master_set$Movement_Type == "1"])
mean(PA_master_set$Duration[PA_master_set$Trial_Type == "4" & PA_master_set$Movement_Type == "1"])
```

```{r}
mean(FV_master_set$Avg_Speed_Per_Bodylength[FV_master_set$Trial_Type == "1"])
mean(FV_master_set$Avg_Speed_Per_Bodylength[FV_master_set$Trial_Type == "4"])

mean(FV_master_set$Avg_Bearing_Change[FV_master_set$Trial_Type == "1"])
mean(FV_master_set$Avg_Bearing_Change[FV_master_set$Trial_Type == "4"])

mean(FV_master_set$Average_Change_Bearing_vs_Heading_FV[FV_master_set$Trial_Type == "1"])
mean(FV_master_set$Average_Change_Bearing_vs_Heading_FV[FV_master_set$Trial_Type == "4"])
```


#Avg Directness Difference (movement type 2)
```{r}
PA_master_set$Trial_Type=as.factor(PA_master_set$Trial_Type)

bearing_change.lme=lme(abs(Avg_Directness_Difference)~Trial_Type*NewDates,random=~1|OC_ID,
                       data=PA_master_set[PA_master_set$Movement_Type==2,])
bearing_change.ANOVA=Anova(bearing_change.lme,type="III")
bearing_change.ANOVA
```
```{r}
unique(PA_master_set$Trial_Type)

predict.data=data.frame(Trial_Type=as.factor(rep(unique(PA_master_set$Trial_Type),2)),NewDates=c(0,0,8,24))

predict.data$predict=predict(bearing_change.lme,newdata = predict.data,level=0)
predicted_data = predict.data

unspun_predy = c(predicted_data$predict[2],predicted_data$predict[4])
spun_predy = c(predicted_data$predict[1],predicted_data$predict[3])
u_dates_pred = c(0,24)
s_dates_pred = c(0,8)

plot(abs(Avg_Directness_Difference)~NewDates,
     data=PA_master_set[PA_master_set$Movement_Type==2&PA_master_set$Trial_Type==4,],
     #log="y",
     ylim=range(abs(PA_master_set$Avg_Directness_Difference[PA_master_set$Movement_Type==2])),
     pch=21,bg="red"
     )
points(abs(Avg_Directness_Difference)~NewDates,
     data=PA_master_set[PA_master_set$Movement_Type==2&PA_master_set$Trial_Type==1,],
     pch=21,bg="blue")

lines(u_dates_pred,unspun_predy)
lines(s_dates_pred,spun_predy)

print(predicted_data)
```
```{r}
PA_DD_SPUN = (PA_master_set$Avg_Directness_Difference[PA_master_set$Movement_Type==2&PA_master_set$Trial_Type==1])
PA_DD_CONTROL = (PA_master_set$Bearing_Change[PA_master_set$Movement_Type==2&PA_master_set$Trial_Type==4])

PA_DD_SPUN_norm <- rnorm(0.25,mean=mean(PA_DD_SPUN, na.rm=TRUE), sd=sd(PA_DD_SPUN, na.rm=TRUE))
PA_DD_CONTROL_norm <- rnorm(0.25,mean=mean(PA_DD_CONTROL, na.rm=TRUE), sd=sd(PA_DD_CONTROL, na.rm=TRUE))

Pltx_DD_CONTROL_2 = c()
Pltx_DD_SPUN_2 = c()
for (i in 1:length(PA_DD_CONTROL)){
  Pltx_DD_CONTROL_2 = c(Pltx_DD_CONTROL_2,1)
}
for (i in 1:length(PA_DD_SPUN)){
  Pltx_DD_SPUN_2 = c(Pltx_DD_SPUN_2,2)
}

for (i in 1:length(Pltx_DD_CONTROL_2)){
  Pltx_DD_CONTROL_2[i] = jitter(Pltx_DD_CONTROL_2[i],factor = 6)
}
for (i in 1:length(Pltx_DD_SPUN_2)){
  Pltx_DD_SPUN_2[i] = jitter(Pltx_DD_SPUN_2[i],factor = 3)
}

boxplot(PA_DD_CONTROL,PA_DD_SPUN,
#main = "Average Directness Difference in Jetting Movements",
ylab = "Radians",
at = c(1,2),
names = c("Control", "Spun"),
las = 2,
col = c("#C1FFC1","#FFAEB9"),
border = "black",
horizontal = FALSE,
notch = FALSE,
range = 0
)

points(x = Pltx_DD_CONTROL_2 ,y = PA_DD_CONTROL,col="black")
points(x = Pltx_DD_SPUN_2 ,y = PA_DD_SPUN,col="black")

```

#Avg speed per body length, movement type 1
```{r}
PA_master_set$Trial_Type=as.factor(PA_master_set$Trial_Type)

bearing_change.lme=lme(abs(Speed_per_Bodylength)~Trial_Type*NewDates,random=~1|OC_ID,
                       data=PA_master_set[PA_master_set$Movement_Type==1,])
bearing_change.ANOVA=Anova(bearing_change.lme,type="III")
bearing_change.ANOVA
```
```{r}
unique(PA_master_set$Trial_Type)

predict.data=data.frame(Trial_Type=as.factor(rep(unique(PA_master_set$Trial_Type),2)),NewDates=c(0,0,8,24))

predict.data$predict=predict(bearing_change.lme,newdata = predict.data,level=0)
predicted_data = predict.data

unspun_predy = c(predicted_data$predict[2],predicted_data$predict[4])
spun_predy = c(predicted_data$predict[1],predicted_data$predict[3])
u_dates_pred = c(0,24)
s_dates_pred = c(0,8)

plot(abs(Speed_per_Bodylength)~NewDates,
     data=PA_master_set[PA_master_set$Movement_Type==1&PA_master_set$Trial_Type==4,],
     #log="y",
     ylim=range(abs(PA_master_set$Speed_per_Bodylength[PA_master_set$Movement_Type==1&PA_master_set$Trial_Type==4])),
     xlim=range(0,24),
     pch=21,bg="red"
     )
points(abs(Speed_per_Bodylength[PA_master_set$Movement_Type==1&PA_master_set$Trial_Type==1])~NewDates[PA_master_set$Movement_Type==1&PA_master_set$Trial_Type==1],
     data=PA_master_set[PA_master_set$Movement_Type==1&PA_master_set$Trial_Type==1,],
     pch=21,bg="blue")

lines(u_dates_pred,unspun_predy,col="red")
lines(s_dates_pred,spun_predy,col="blue")

print(predicted_data)
```
```{r}
PA_SPB_SPUN = abs(PA_master_set$Speed_per_Bodylength[PA_master_set$Movement_Type==1&PA_master_set$Trial_Type==1])
PA_SPB_CONTROL = abs(PA_master_set$Speed_per_Bodylength[PA_master_set$Movement_Type==1&PA_master_set$Trial_Type==4])

PA_SPB_SPUN_norm <- rnorm(0.25,mean=mean(PA_SPB_SPUN, na.rm=TRUE), sd=sd(PA_SPB_SPUN, na.rm=TRUE))
PA_SPB_CONTROL_norm <- rnorm(0.25,mean=mean(PA_SPB_CONTROL, na.rm=TRUE), sd=sd(PA_SPB_CONTROL, na.rm=TRUE))

Pltx_SPB_CONTROL_1 = c()
Pltx_SPB_SPUN_1 = c()
for (i in 1:length(PA_SPB_CONTROL)){
  Pltx_SPB_CONTROL_1 = c(Pltx_SPB_CONTROL_1,1)
}
for (i in 1:length(PA_SPB_SPUN)){
  Pltx_SPB_SPUN_1 = c(Pltx_SPB_SPUN_1,2)
}

for (i in 1:length(Pltx_SPB_CONTROL_1)){
  Pltx_SPB_CONTROL_1[i] = jitter(Pltx_SPB_CONTROL_1[i],factor = 8)
}
for (i in 1:length(Pltx_SPB_SPUN_1)){
  Pltx_SPB_SPUN_1[i] = jitter(Pltx_SPB_SPUN_1[i],factor = 3)
}

boxplot(PA_SPB_CONTROL,PA_SPB_SPUN,
#main = "Average Speed per Bodylength in Crawling Movements",
ylab = "Size-corrected speed units",
ylim = range(0,1.4),
at = c(1,2),
names = c("Control", "Spun"),
las = 2,
col = c("#C1FFC1","#FFAEB9"),
border = "black",
horizontal = FALSE,
notch = FALSE,
range = 0
)

points(x = Pltx_SPB_CONTROL_1 ,y = PA_SPB_CONTROL,col="black")
points(x = Pltx_SPB_SPUN_1 ,y = PA_SPB_SPUN,col="black")

```


#Avg speed per body length, movement type 2
```{r}
PA_master_set$Trial_Type=as.factor(PA_master_set$Trial_Type)

bearing_change.lme=lme(abs(Speed_per_Bodylength)~Trial_Type*NewDates,random=~1|OC_ID,
                       data=PA_master_set[PA_master_set$Movement_Type==2,])
bearing_change.ANOVA=Anova(bearing_change.lme,type="III")
bearing_change.ANOVA
```
```{r}
unique(PA_master_set$Trial_Type)

predict.data=data.frame(Trial_Type=as.factor(rep(unique(PA_master_set$Trial_Type),2)),NewDates=c(0,0,8,24))

predict.data$predict=predict(bearing_change.lme,newdata = predict.data,level=0)
predicted_data = predict.data

unspun_predy = c(predicted_data$predict[2],predicted_data$predict[4])
spun_predy = c(predicted_data$predict[1],predicted_data$predict[3])
u_dates_pred = c(0,24)
s_dates_pred = c(0,8)

plot(abs(Speed_per_Bodylength[PA_master_set$Movement_Type==2&PA_master_set$Trial_Type==4])~NewDates[PA_master_set$Movement_Type==2&PA_master_set$Trial_Type==4],
     data=PA_master_set[PA_master_set$Movement_Type==2&PA_master_set$Trial_Type==4,],
     #log="y",
     ylim=range(abs(PA_master_set$Speed_per_Bodylength[PA_master_set$Movement_Type==2])),
     pch=21,bg="red"
     )
points(abs(Speed_per_Bodylength[PA_master_set$Movement_Type==2&PA_master_set$Trial_Type==1])~NewDates[PA_master_set$Movement_Type==2&PA_master_set$Trial_Type==1],
     data=PA_master_set[PA_master_set$Movement_Type==2&PA_master_set$Trial_Type==1,],
     pch=21,bg="blue")

lines(u_dates_pred,unspun_predy)
lines(s_dates_pred,spun_predy)

print(predicted_data)
```
```{r}
PA_SPB_SPUN = abs(PA_master_set$Speed_per_Bodylength[PA_master_set$Movement_Type==2&PA_master_set$Trial_Type==1])
PA_SPB_CONTROL = abs(PA_master_set$Speed_per_Bodylength[PA_master_set$Movement_Type==2&PA_master_set$Trial_Type==4])

PA_SPB_SPUN_norm <- rnorm(4,mean=mean(PA_SPB_SPUN, na.rm=TRUE), sd=sd(PA_SPB_SPUN, na.rm=TRUE))
PA_SPB_CONTROL_norm <- rnorm(84,mean=mean(PA_SPB_CONTROL, na.rm=TRUE), sd=sd(PA_SPB_CONTROL, na.rm=TRUE))

Pltx_SPB_CONTROL_2 = c()
Pltx_SPB_SPUN_2 = c()
for (i in 1:length(PA_SPB_CONTROL)){
  Pltx_SPB_CONTROL_2 = c(Pltx_SPB_CONTROL_2,1)
}
for (i in 1:length(PA_SPB_SPUN)){
  Pltx_SPB_SPUN_2 = c(Pltx_SPB_SPUN_2,2)
}

for (i in 1:length(Pltx_SPB_CONTROL_2)){
  Pltx_SPB_CONTROL_2[i] = jitter(Pltx_SPB_CONTROL_2[i],factor = 12)
}
for (i in 1:length(Pltx_SPB_SPUN_2)){
  Pltx_SPB_SPUN_2[i] = jitter(Pltx_SPB_SPUN_2[i],factor = 3)
}

boxplot(PA_SPB_CONTROL,PA_SPB_SPUN,
#main = "Average Speed per Bodylength in Jetting Movements",
ylab = "Size-corrected speed units",
at = c(1,2),
names = c("Control", "Spun"),
las = 2,
col = c("#C1FFC1","#FFAEB9"),
border = "black",
horizontal = FALSE,
notch = FALSE,
range = 0
)

points(x = Pltx_SPB_CONTROL_2 ,y = PA_SPB_CONTROL,col="black")
points(x = Pltx_SPB_SPUN_2 ,y = PA_SPB_SPUN,col="black")

```

#Avg bearing change (movement type 1)
```{r}
PA_master_set$Trial_Type=as.factor(PA_master_set$Trial_Type)

bearing_change.lme=lme(abs(Bearing_Change)~Trial_Type*NewDates,random=~1|OC_ID,
                       data=PA_master_set[PA_master_set$Movement_Type==1,])
bearing_change.ANOVA=Anova(bearing_change.lme,type="III")
bearing_change.ANOVA

```
```{r}
unique(PA_master_set$Trial_Type)

predict.data=data.frame(Trial_Type=as.factor(rep(unique(PA_master_set$Trial_Type),2)),NewDates=c(0,0,8,24))

predict.data$predict=predict(bearing_change.lme,newdata = predict.data,level=0)
predicted_data = predict.data

unspun_predy = c(predicted_data$predict[2],predicted_data$predict[4])
spun_predy = c(predicted_data$predict[1],predicted_data$predict[3])
u_dates_pred = c(0,24)
s_dates_pred = c(0,8)

plot(Bearing_Change~NewDates,
     data=PA_master_set[PA_master_set$Movement_Type==1&PA_master_set$Trial_Type==4,],
     #log="y",
     #main = "Duration of Directed movements",
     ylim=range(-100,100),
     xlim = range(0,25),
     ylab = "Degrees",
     xlab = "Trial number",
     pch=21,bg="#52c155"
     )
points(Bearing_Change~NewDates,
     data=PA_master_set[PA_master_set$Movement_Type==1&PA_master_set$Trial_Type==1,],
     pch=21,bg="#eb3a23")
legend("bottom",c("Spun","Control"),fill = c("#eb3a23","#52c155"), cex = 0.55)

lines(u_dates_pred,unspun_predy, col = "#52c155",lwd = 1.75)
lines(s_dates_pred,spun_predy, col = "red",lwd = 1.75)

print(predicted_data)
```


```{r}
PA_BC_SPUN = (PA_master_set$Bearing_Change[PA_master_set$Movement_Type==1&PA_master_set$Trial_Type==1])
PA_BC_CONTROL = (PA_master_set$Bearing_Change[PA_master_set$Movement_Type==1&PA_master_set$Trial_Type==4])

PA_BC_SPUN_norm <- rnorm(4,mean=mean(PA_SPB_SPUN, na.rm=TRUE), sd=sd(PA_SPB_SPUN, na.rm=TRUE))
PA_BC_CONTROL_norm <- rnorm(84,mean=mean(PA_SPB_CONTROL, na.rm=TRUE), sd=sd(PA_SPB_CONTROL, na.rm=TRUE))

Pltx_BC_CONTROL_1 = c()
Pltx_BC_SPUN_1 = c()
for (i in 1:length(PA_BC_CONTROL)){
  Pltx_BC_CONTROL_1 = c(Pltx_BC_CONTROL_1,1)
}
for (i in 1:length(PA_BC_SPUN)){
  Pltx_BC_SPUN_1 = c(Pltx_BC_SPUN_1,2)
}

for (i in 1:length(Pltx_BC_CONTROL_1)){
  Pltx_BC_CONTROL_1[i] = jitter(Pltx_BC_CONTROL_1[i],factor = 12)
}
for (i in 1:length(Pltx_BC_SPUN_1)){
  Pltx_BC_SPUN_1[i] = jitter(Pltx_BC_SPUN_1[i],factor = 3)
}

boxplot(PA_BC_CONTROL,PA_BC_SPUN,
ylab = "Degrees",
ylim = range(-180,180),
yaxp = c(-180,180,9),
at = c(1,2),
names = c("Control", "Spun"),
las = 2,
col = c("#C1FFC1","#FFAEB9"),
border = "black",
horizontal = FALSE,
notch = FALSE,
range = 0
)

points(x = Pltx_BC_CONTROL_1 ,y = PA_BC_CONTROL,col="black")
points(x = Pltx_BC_SPUN_1 ,y = PA_BC_SPUN,col="black")

```

#Avg bearing change (movement type 2)
```{r}
PA_master_set$Trial_Type=as.factor(PA_master_set$Trial_Type)

bearing_change.lme=lme(abs(Bearing_Change)~Trial_Type*NewDates,random=~1|OC_ID,
                       data=PA_master_set[PA_master_set$Movement_Type==2,])
bearing_change.ANOVA=Anova(bearing_change.lme,type="III")
bearing_change.ANOVA

```
```{r}
PA_BC_SPUN = (PA_master_set$Bearing_Change[PA_master_set$Movement_Type==2&PA_master_set$Trial_Type==1])
PA_BC_CONTROL = (PA_master_set$Bearing_Change[PA_master_set$Movement_Type==2&PA_master_set$Trial_Type==4])

PA_BC_SPUN_norm <- rnorm(4,mean=mean(PA_SPB_SPUN, na.rm=TRUE), sd=sd(PA_SPB_SPUN, na.rm=TRUE))
PA_BC_CONTROL_norm <- rnorm(84,mean=mean(PA_SPB_CONTROL, na.rm=TRUE), sd=sd(PA_SPB_CONTROL, na.rm=TRUE))

Pltx_BC_CONTROL_2 = c()
Pltx_BC_SPUN_2 = c()
for (i in 1:length(PA_BC_CONTROL)){
  Pltx_BC_CONTROL_2 = c(Pltx_BC_CONTROL_2,1)
}
for (i in 1:length(PA_BC_SPUN)){
  Pltx_BC_SPUN_2 = c(Pltx_BC_SPUN_2,2)
}

for (i in 1:length(Pltx_BC_CONTROL_2)){
  Pltx_BC_CONTROL_2[i] = jitter(Pltx_BC_CONTROL_2[i],factor = 12)
}
for (i in 1:length(Pltx_BC_SPUN_2)){
  Pltx_BC_SPUN_2[i] = jitter(Pltx_BC_SPUN_2[i],factor = 3)
}

boxplot(PA_BC_CONTROL,PA_BC_SPUN,
ylab = "Radians",
at = c(1,2),
names = c("Control", "Spun"),
las = 2,
col = c("#C1FFC1","#FFAEB9"),
border = "black",
horizontal = FALSE,
notch = FALSE,
range = 0
)

points(x = Pltx_BC_CONTROL_2 ,y = PA_BC_CONTROL,col="black")
points(x = Pltx_BC_SPUN_2 ,y = PA_BC_SPUN,col="black")

```


#Avg Bearing vs Heading, movement type == 1
```{r}
PA_master_set$Trial_Type=as.factor(PA_master_set$Trial_Type)

bearing_change.lme=lme(abs(Avg_Bearing_vs_Heading)~Trial_Type*NewDates,random=~1|OC_ID,
                       data=PA_master_set[PA_master_set$Movement_Type==1,])
bearing_change.ANOVA=Anova(bearing_change.lme,type="III")
bearing_change.ANOVA
```
```{r}
unique(PA_master_set$Trial_Type)

predict.data=data.frame(Trial_Type=as.factor(rep(unique(PA_master_set$Trial_Type),2)),NewDates=c(0,0,8,24))

predict.data$predict=predict(bearing_change.lme,newdata = predict.data,level=0)
predicted_data = predict.data

unspun_predy = c(predicted_data$predict[2],predicted_data$predict[4])
spun_predy = c(predicted_data$predict[1],predicted_data$predict[3])
u_dates_pred = c(0,24)
s_dates_pred = c(0,8)

plot(abs(Avg_Bearing_vs_Heading)~NewDates,
     data=PA_master_set[PA_master_set$Movement_Type==1&PA_master_set$Trial_Type==4,],
     #log="y",
     ylim=range(abs(PA_master_set$Bearing_Change[PA_master_set$Movement_Type==1])),
     pch=21,bg="red"
     )
points(abs(Avg_Bearing_vs_Heading)~NewDates,
     data=PA_master_set[PA_master_set$Movement_Type==1&PA_master_set$Trial_Type==1,],
     pch=21,bg="blue")

lines(u_dates_pred,unspun_predy)
lines(s_dates_pred,spun_predy)

print(predicted_data)
```
```{r}
PA_BvH_SPUN = (PA_master_set$Avg_Bearing_vs_Heading[PA_master_set$Movement_Type==1&PA_master_set$Trial_Type==1])
PA_BvH_CONTROL = (PA_master_set$Avg_Bearing_vs_Heading[PA_master_set$Movement_Type==1&PA_master_set$Trial_Type==4])

PA_BvH_SPUN_norm <- rnorm(0.25,mean=mean(PA_BvH_SPUN, na.rm=TRUE), sd=sd(PA_BvH_SPUN, na.rm=TRUE))
PA_BvH_CONTROL_norm <- rnorm(0.25,mean=mean(PA_BvH_CONTROL, na.rm=TRUE), sd=sd(PA_BvH_CONTROL, na.rm=TRUE))

Pltx_BvH_CONTROL_1 = c()
Pltx_BvH_SPUN_1 = c()
for (i in 1:length(PA_BvH_CONTROL)){
  Pltx_BvH_CONTROL_1 = c(Pltx_BvH_CONTROL_1,1)
}
for (i in 1:length(PA_BvH_SPUN)){
  Pltx_BvH_SPUN_1 = c(Pltx_BvH_SPUN_1,2)
}

for (i in 1:length(Pltx_BvH_CONTROL_1)){
  Pltx_BvH_CONTROL_1[i] = jitter(Pltx_BvH_CONTROL_1[i],factor = 6)
}
for (i in 1:length(Pltx_BvH_SPUN_1)){
  Pltx_BvH_SPUN_1[i] = jitter(Pltx_BvH_SPUN_1[i],factor = 3)
}

boxplot(PA_BvH_CONTROL,PA_BvH_SPUN,
#main = "Average Bearing-Heading Difference in Crawling Movements",
xlab = "Degrees",
ylim = range(-180,180),
xaxp = c(-180, 180, 9),
at = c(1,2),
names = c("Control", "Spun"),
las = 2,
col = c("#C1FFC1","#FFAEB9"),
border = "black",
horizontal = TRUE,
notch = FALSE,
range = 0
)

points(x = PA_BvH_CONTROL ,y = Pltx_BvH_CONTROL_1,col="black")
points(x = PA_BvH_SPUN ,y = Pltx_BvH_SPUN_1,col="black")
abline(v = 0, col = 'black', lwd = 2)
```
```{r}
histogram(
  PA_master_set$Avg_Bearing_vs_Heading[PA_master_set$Movement_Type==1&PA_master_set$Trial_Type==1],
  allow.multiple,
  aspect = "fill",
  xlim = c(-180,180),
  xlab = "Degrees",
  ylim = c(0,25),
  ylab = "Percent of total number of trials",
  breaks = 10,
  col = "#FFAEB9")
```
```{r}
histogram(
  PA_master_set$Avg_Bearing_vs_Heading[PA_master_set$Movement_Type==1&PA_master_set$Trial_Type==4],
  allow.multiple,
  aspect = "fill",
  xlim = c(-180,180),
  xlab = "Degrees",
  ylim = c(0,25),
  ylab = "Percent of total number of trials",
  breaks = 10,
  col = "#C1FFC1")
```


#Avg Bearing vs Heading, movement type == 2
```{r}
PA_master_set$Trial_Type=as.factor(PA_master_set$Trial_Type)

bearing_change.lme=lme(abs(Avg_Bearing_vs_Heading)~Trial_Type*NewDates,random=~1|OC_ID,
                       data=PA_master_set[PA_master_set$Movement_Type==2,])
bearing_change.ANOVA=Anova(bearing_change.lme,type="III")
bearing_change.ANOVA
```
```{r}
unique(PA_master_set$Trial_Type)

predict.data=data.frame(Trial_Type=as.factor(rep(unique(PA_master_set$Trial_Type),2)),NewDates=c(0,0,8,24))

predict.data$predict=predict(bearing_change.lme,newdata = predict.data,level=0)
predicted_data = predict.data

unspun_predy = c(predicted_data$predict[2],predicted_data$predict[4])
spun_predy = c(predicted_data$predict[1],predicted_data$predict[3])
u_dates_pred = c(0,24)
s_dates_pred = c(0,8)

plot(abs(Avg_Bearing_vs_Heading)~NewDates,
     data=PA_master_set[PA_master_set$Movement_Type==2&PA_master_set$Trial_Type==4,],
     main= "Bearing-heading difference in jetting movements" ,
     #log="y",
     ylim=range(abs(PA_master_set$Avg_Bearing_vs_Heading[PA_master_set$Movement_Type==2])),
     pch=21,bg="red"
     )
points(abs(Avg_Bearing_vs_Heading)~NewDates,
     data=PA_master_set[PA_master_set$Movement_Type==2&PA_master_set$Trial_Type==1,],
     pch=21,bg="blue")

lines(u_dates_pred,unspun_predy)
lines(s_dates_pred,spun_predy)

print(predicted_data)
```
```{r}
PA_BvH_SPUN = (PA_master_set$Avg_Bearing_vs_Heading[PA_master_set$Movement_Type==2&PA_master_set$Trial_Type==1])
PA_BvH_CONTROL = (PA_master_set$Avg_Bearing_vs_Heading[PA_master_set$Movement_Type==2&PA_master_set$Trial_Type==4])

PA_BvH_SPUN_norm <- rnorm(4,mean=mean(PA_BvH_SPUN, na.rm=TRUE), sd=sd(PA_BvH_SPUN, na.rm=TRUE))
PA_BvH_CONTROL_norm <- rnorm(84,mean=mean(PA_BvH_CONTROL, na.rm=TRUE), sd=sd(PA_BvH_CONTROL, na.rm=TRUE))

Pltx_BvH_CONTROL_2 = c()
Pltx_BvH_SPUN_2 = c()
for (i in 1:length(PA_BvH_CONTROL)){
  Pltx_BvH_CONTROL_2 = c(Pltx_BvH_CONTROL_2,1)
}
for (i in 1:length(PA_BvH_SPUN)){
  Pltx_BvH_SPUN_2 = c(Pltx_BvH_SPUN_2,2)
}

for (i in 1:length(Pltx_BvH_CONTROL_2)){
  Pltx_BvH_CONTROL_2[i] = jitter(Pltx_BvH_CONTROL_2[i],factor = 6)
}
for (i in 1:length(Pltx_BvH_SPUN_2)){
  Pltx_BvH_SPUN_2[i] = jitter(Pltx_BvH_SPUN_2[i],factor = 3)
}

boxplot(PA_BvH_CONTROL,PA_BvH_SPUN,
ylab = "Radians",
at = c(1,2),
names = c("Control", "Spun"),
las = 2,
col = c("#C1FFC1","#FFAEB9"),
border = "black",
horizontal = FALSE,
notch = FALSE,
range = 0
)

points(x = Pltx_BvH_CONTROL_2 ,y = PA_BvH_CONTROL,col="black")
points(x = Pltx_BvH_SPUN_2 ,y = PA_BvH_SPUN,col="black")

```

#Average Heading vs Bearing Change, Movement Type == 1
```{r}
PA_master_set$Trial_Type=as.factor(PA_master_set$Trial_Type)

bearing_change.lme=lme(abs(Avg_Bearing_vs_Heading_Change)~Trial_Type*NewDates,random=~1|OC_ID,
                       data=PA_master_set[PA_master_set$Movement_Type==1,])
bearing_change.ANOVA=Anova(bearing_change.lme,type="III")
bearing_change.ANOVA
```
```{r}
unique(PA_master_set$Trial_Type)

predict.data=data.frame(Trial_Type=as.factor(rep(unique(PA_master_set$Trial_Type),2)),NewDates=c(0,0,8,24))

predict.data$predict=predict(bearing_change.lme,newdata = predict.data,level=0)
predicted_data = predict.data

unspun_predy = c(predicted_data$predict[2],predicted_data$predict[4])
spun_predy = c(predicted_data$predict[1],predicted_data$predict[3])
u_dates_pred = c(0,24)
s_dates_pred = c(0,8)

plot(abs(Avg_Bearing_vs_Heading_Change)~NewDates,
     data=PA_master_set[PA_master_set$Movement_Type==1&PA_master_set$Trial_Type==4,],
     #log="y",
     ylim=range(abs(PA_master_set$Avg_Bearing_vs_Heading_Change[PA_master_set$Movement_Type==2])),
     pch=21,bg="red"
     )
points(abs(Avg_Bearing_vs_Heading_Change)~NewDates,
     data=PA_master_set[PA_master_set$Movement_Type==1&PA_master_set$Trial_Type==1,],
     pch=21,bg="blue")

lines(u_dates_pred,unspun_predy)
lines(s_dates_pred,spun_predy)

print(predicted_data)
```
```{r}
PA_BvHC_SPUN = abs(PA_master_set$Avg_Bearing_vs_Heading_Change[PA_master_set$Movement_Type==1&PA_master_set$Trial_Type==1])
PA_BvHC_CONTROL = abs(PA_master_set$Avg_Bearing_vs_Heading_Change[PA_master_set$Movement_Type==1&PA_master_set$Trial_Type==4])

PA_BvHC_SPUN_norm <- rnorm(0.25,mean=mean(PA_BvHC_SPUN, na.rm=TRUE), sd=sd(PA_BvHC_SPUN, na.rm=TRUE))
PA_BvHC_CONTROL_norm <- rnorm(0.25,mean=mean(PA_BvHC_CONTROL, na.rm=TRUE), sd=sd(PA_BvHC_CONTROL, na.rm=TRUE))

Pltx_BvHC_CONTROL_1 = c()
Pltx_BvHC_SPUN_1 = c()
for (i in 1:length(PA_BvHC_CONTROL)){
  Pltx_BvHC_CONTROL_1 = c(Pltx_BvHC_CONTROL_1,1)
}
for (i in 1:length(PA_BvHC_SPUN)){
  Pltx_BvHC_SPUN_1 = c(Pltx_BvHC_SPUN_1,2)
}

for (i in 1:length(Pltx_BvHC_CONTROL_1)){
  Pltx_BvHC_CONTROL_1[i] = jitter(Pltx_BvHC_CONTROL_1[i],factor = 6)
}
for (i in 1:length(Pltx_BvHC_SPUN_1)){
  Pltx_BvHC_SPUN_1[i] = jitter(Pltx_BvHC_SPUN_1[i],factor = 3)
}


boxplot(PA_BvHC_CONTROL,PA_BvHC_SPUN,
#main = "Avg. Change in Bearing-Heading Difference - Crawling",
ylab = "Degrees",
at = c(1,2),
names = c("Control", "Spun"),
las = 2,
col = c("#C1FFC1","#FFAEB9"),
border = "black",
horizontal = FALSE,
notch = FALSE,
range = 0
)

points(x = Pltx_BvHC_CONTROL_1 ,y = PA_BvHC_CONTROL,col="black")
points(x = Pltx_BvHC_SPUN_1 ,y = PA_BvHC_SPUN,col="black")

```


#Average Heading vs Bearing Change, Movement Type == 2
```{r}
PA_master_set$Trial_Type=as.factor(PA_master_set$Trial_Type)

bearing_change.lme=lme(abs(Avg_Bearing_vs_Heading_Change)~Trial_Type*NewDates,random=~1|OC_ID,
                       data=PA_master_set[PA_master_set$Movement_Type==2,])
bearing_change.ANOVA=Anova(bearing_change.lme,type="III")
bearing_change.ANOVA
```
```{r}
unique(PA_master_set$Trial_Type)

predict.data=data.frame(Trial_Type=as.factor(rep(unique(PA_master_set$Trial_Type),2)),NewDates=c(0,0,8,24))

predict.data$predict=predict(bearing_change.lme,newdata = predict.data,level=0)
predicted_data = predict.data

unspun_predy = c(predicted_data$predict[2],predicted_data$predict[4])
spun_predy = c(predicted_data$predict[1],predicted_data$predict[3])
u_dates_pred = c(0,24)
s_dates_pred = c(0,8)

plot(abs(Avg_Bearing_vs_Heading_Change)~NewDates,
     data=PA_master_set[PA_master_set$Movement_Type==2&PA_master_set$Trial_Type==4,],
     #log="y",
     ylim=range(abs(PA_master_set$Avg_Bearing_vs_Heading_Change[PA_master_set$Movement_Type==2])),
     pch=21,bg="red"
     )
points(abs(Avg_Bearing_vs_Heading_Change)~NewDates,
     data=PA_master_set[PA_master_set$Movement_Type==2&PA_master_set$Trial_Type==1,],
     pch=21,bg="blue")

lines(u_dates_pred,unspun_predy)
lines(s_dates_pred,spun_predy)

print(predicted_data)
```
```{r}
PA_BvHC_SPUN = abs(PA_master_set$Avg_Bearing_vs_Heading_Change[PA_master_set$Movement_Type==2&PA_master_set$Trial_Type==1])
PA_BvHC_CONTROL = abs(PA_master_set$Avg_Bearing_vs_Heading_Change[PA_master_set$Movement_Type==2&PA_master_set$Trial_Type==4])

PA_BvHC_SPUN_norm <- rnorm(0.25,mean=mean(PA_BvHC_SPUN, na.rm=TRUE), sd=sd(PA_BvHC_SPUN, na.rm=TRUE))
PA_BvHC_CONTROL_norm <- rnorm(0.25,mean=mean(PA_BvHC_CONTROL, na.rm=TRUE), sd=sd(PA_BvHC_CONTROL, na.rm=TRUE))

Pltx_BvHC_CONTROL_2 = c()
Pltx_BvHC_SPUN_2 = c()
for (i in 1:length(PA_BvHC_CONTROL)){
  Pltx_BvHC_CONTROL_2 = c(Pltx_BvHC_CONTROL_2,1)
}
for (i in 1:length(PA_BvHC_SPUN)){
  Pltx_BvHC_SPUN_2 = c(Pltx_BvHC_SPUN_2,2)
}

for (i in 1:length(Pltx_BvHC_CONTROL_2)){
  Pltx_BvHC_CONTROL_2[i] = jitter(Pltx_BvHC_CONTROL_2[i],factor = 6)
}
for (i in 1:length(Pltx_BvHC_SPUN_2)){
  Pltx_BvHC_SPUN_2[i] = jitter(Pltx_BvHC_SPUN_2[i],factor = 3)
}


boxplot(PA_BvHC_CONTROL,PA_BvHC_SPUN,
#main = "Avg. Change in Bearing-Heading Difference - Jetting",
ylab = "Radians",
at = c(1,2),
names = c("Control", "Spun"),
las = 2,
col = c("#C1FFC1","#FFAEB9"),
border = "black",
horizontal = FALSE,
notch = FALSE,
range = 0
)

points(x = Pltx_BvHC_CONTROL_2 ,y = PA_BvHC_CONTROL,col="black")
points(x = Pltx_BvHC_SPUN_2 ,y = PA_BvHC_SPUN,col="black")

```


#Duration, Movement Type ==  1
```{r}
PA_master_set$Trial_Type=as.factor(PA_master_set$Trial_Type)

bearing_change.lme=lme(abs(Duration)~Trial_Type*NewDates,random=~1|OC_ID,
                       data=PA_master_set[PA_master_set$Movement_Type==1,])
bearing_change.ANOVA=Anova(bearing_change.lme,type="III")
bearing_change.ANOVA
```
```{r}
unique(PA_master_set$Trial_Type)

predict.data=data.frame(Trial_Type=as.factor(rep(unique(PA_master_set$Trial_Type),2)),NewDates=c(0,0,8,24))

predict.data$predict=predict(bearing_change.lme,newdata = predict.data,level=0)
predicted_data = predict.data

unspun_predy = c(predicted_data$predict[2],predicted_data$predict[4])
spun_predy = c(predicted_data$predict[1],predicted_data$predict[3])
u_dates_pred = c(0,24)
s_dates_pred = c(0,8)

plot(Duration~NewDates,
     data=PA_master_set[PA_master_set$Movement_Type==1&PA_master_set$Trial_Type==4,],
     #log="y",
     ylim=range(abs(PA_master_set$Duration[PA_master_set$Movement_Type==2])),
     pch=21,bg="red"
     )
points(Duration~NewDates,
     data=PA_master_set[PA_master_set$Movement_Type==1&PA_master_set$Trial_Type==1,],
     pch=21,bg="blue")

lines(u_dates_pred,unspun_predy)
lines(s_dates_pred,spun_predy)

print(predicted_data)
```
```{r}
PA_Duration_SPUN = abs(PA_master_set$Duration[PA_master_set$Movement_Type==1&PA_master_set$Trial_Type==1])
PA_Duration_CONTROL = abs(PA_master_set$Duration[PA_master_set$Movement_Type==1&PA_master_set$Trial_Type==4])

PA_Duration_SPUN_norm <- rnorm(0.25,mean=mean(PA_Duration_SPUN, na.rm=TRUE), sd=sd(PA_Duration_SPUN, na.rm=TRUE))
PA_Duration_CONTROL_norm <- rnorm(0.25,mean=mean(PA_Duration_CONTROL, na.rm=TRUE), sd=sd(PA_Duration_CONTROL, na.rm=TRUE))

Pltx_Duration_CONTROL_1 = c()
Pltx_Duration_SPUN_1 = c()
for (i in 1:length(PA_Duration_CONTROL)){
  Pltx_Duration_CONTROL_1 = c(Pltx_Duration_CONTROL_1,1)
}
for (i in 1:length(PA_Duration_SPUN)){
  Pltx_Duration_SPUN_1 = c(Pltx_Duration_SPUN_1,2)
}

for (i in 1:length(Pltx_Duration_CONTROL_1)){
  Pltx_Duration_CONTROL_1[i] = jitter(Pltx_Duration_CONTROL_1[i],factor = 6)
}
for (i in 1:length(Pltx_Duration_SPUN_1)){
  Pltx_Duration_SPUN_1[i] = jitter(Pltx_Duration_SPUN_1[i],factor = 3)
}

boxplot(PA_Duration_CONTROL,PA_Duration_SPUN,
#main = "Duration of Crawling Movements",
ylab = "Seconds",
at = c(1,2),
names = c("Control", "Spun"),
las = 2,
col = c("#C1FFC1","#FFAEB9"),
border = "black",
horizontal = FALSE,
notch = FALSE,
range = 0
)

points(x = Pltx_Duration_CONTROL_1 ,y = PA_Duration_CONTROL,col="black")
points(x = Pltx_Duration_SPUN_1 ,y = PA_Duration_SPUN,col="black")

```


#Duration, Movement Type ==  2
```{r}
PA_master_set$Trial_Type=as.factor(PA_master_set$Trial_Type)

bearing_change.lme=lme(abs(Duration)~Trial_Type*NewDates,random=~1|OC_ID,
                       data=PA_master_set[PA_master_set$Movement_Type==2,])
bearing_change.ANOVA=Anova(bearing_change.lme,type="III")
bearing_change.ANOVA
```
```{r}
unique(PA_master_set$Trial_Type)

predict.data=data.frame(Trial_Type=as.factor(rep(unique(PA_master_set$Trial_Type),2)),NewDates=c(0,0,8,24))

predict.data$predict=predict(bearing_change.lme,newdata = predict.data,level=0)
predicted_data = predict.data

unspun_predy = c(predicted_data$predict[2],predicted_data$predict[4])
spun_predy = c(predicted_data$predict[1],predicted_data$predict[3])
u_dates_pred = c(0,24)
s_dates_pred = c(0,8)

plot(Duration~NewDates,
     data=PA_master_set[PA_master_set$Movement_Type==2&PA_master_set$Trial_Type==4,],
     #log="y",
     #main = "Duration of Directed movements",
     ylim=range(0,5),
     xlim = range(0,25),
     ylab = "Seconds",
     xlab = "Date",
     pch=21,bg="#52c155"
     )
points(Duration~NewDates,
     data=PA_master_set[PA_master_set$Movement_Type==2&PA_master_set$Trial_Type==1,],
     pch=21,bg="#eb3a23")
legend("topright",c("Spun","Control"),fill = c("#eb3a23","#52c155"), cex = 0.45)

lines(u_dates_pred,unspun_predy, col = "#52c155",lwd = 1.75)
lines(s_dates_pred,spun_predy, col = "red",lwd = 1.75)

print(predicted_data)
```
```{r}
PA_Duration_SPUN = abs(PA_master_set$Duration[PA_master_set$Movement_Type==2&PA_master_set$Trial_Type==1])
PA_Duration_CONTROL = abs(PA_master_set$Duration[PA_master_set$Movement_Type==2&PA_master_set$Trial_Type==4])

PA_Duration_SPUN_norm <- rnorm(0.25,mean=mean(PA_Duration_SPUN, na.rm=TRUE), sd=sd(PA_Duration_SPUN, na.rm=TRUE))
PA_Duration_CONTROL_norm <- rnorm(0.25,mean=mean(PA_Duration_CONTROL, na.rm=TRUE), sd=sd(PA_Duration_CONTROL, na.rm=TRUE))

Pltx_Duration_CONTROL_2 = c()
Pltx_Duration_SPUN_2 = c()
for (i in 1:length(PA_Duration_CONTROL)){
  Pltx_Duration_CONTROL_2 = c(Pltx_Duration_CONTROL_2,1)
}
for (i in 1:length(PA_Duration_SPUN)){
  Pltx_Duration_SPUN_2 = c(Pltx_Duration_SPUN_2,2)
}

for (i in 1:length(Pltx_Duration_CONTROL_2)){
  Pltx_Duration_CONTROL_2[i] = jitter(Pltx_Duration_CONTROL_2[i],factor = 10)
}
for (i in 1:length(Pltx_Duration_SPUN_2)){
  Pltx_Duration_SPUN_2[i] = jitter(Pltx_Duration_SPUN_2[i],factor = 3)
}

boxplot(PA_Duration_CONTROL,PA_Duration_SPUN,
#main = "Duration of Crawling Movements",
ylab = "Seconds",
at = c(1,2),
names = c("Control", "Spun"),
las = 2,
col = c("#C1FFC1","#FFAEB9"),
border = "black",
horizontal = FALSE,
notch = FALSE,
range = 0
)

points(x = Pltx_Duration_CONTROL_2 ,y = PA_Duration_CONTROL,col="black")
points(x = Pltx_Duration_SPUN_2 ,y = PA_Duration_SPUN,col="black")

```


#################
#FULL VIDEO ANALYSIS
#################
#Duration
```{r}
FV_master_set$Trial_Type=as.factor(FV_master_set$Trial_Type)

bearing_change.lme=lme(Duration~Trial_Type,random=~1|OC_ID, 
                       correlation=corAR1(form= ~NewDates|OC_ID),
                       data=FV_master_set)

bearing_change.ANOVA=Anova(bearing_change.lme,type="III")
bearing_change.ANOVA
#summary(bearing_change.lme)
#AIC(bearing_change.lme) 
```
```{r}
FV_master_set$Trial_Type=as.factor(FV_master_set$Trial_Type)

bearing_change.lme=lme((Duration)~Trial_Type*NewDates,random=~1|OC_ID,
                       data=FV_master_set)

bearing_change.ANOVA=Anova(bearing_change.lme,type="III")
bearing_change.ANOVA
#summary(bearing_change.lme)
#AIC(bearing_change.lme) 
```

```{r}
unique(FV_master_set$Trial_Type)
date_l = c(0,0,8,24)
predict.data=data.frame(Trial_Type=as.factor(rep(unique(FV_master_set$Trial_Type),32)),NewDates=rep(date_l,16),OC_ID=c(1,1,1,1,2,2,2,2,4,4,4,4,5,5,5,5,7,7,7,7,8,8,8,8,9,9,9,9,10,10,10,10,11,11,11,11,12,12,12,12,13,13,13,13,14,14,14,14,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19))

predict.data$predict=predict(bearing_change.lme,newdata = predict.data,level=0)
predicted_data = predict.data

unspun_predy = c(predicted_data$predict[2],predicted_data$predict[4])
spun_predy = c(predicted_data$predict[1],predicted_data$predict[3])
u_dates_pred = c(0,24)
s_dates_pred = c(0,8)

plot(Duration~NewDates,
     data=FV_master_set[FV_master_set$Trial_Type==4,],
     #log="y",
     ylim=range(abs(FV_master_set$Duration)),
     pch=21,bg="red"
     )
points(Duration~NewDates,
     data=FV_master_set[FV_master_set$Trial_Type==1,],
     pch=21,bg="blue")

lines(u_dates_pred,unspun_predy)
lines(s_dates_pred,spun_predy)
plot(bearing_change.lme, which = 1)
```
```{r}
FV_Duration_SPUN = abs(FV_master_set$Duration[FV_master_set$Trial_Type==1])
FV_Duration_CONTROL = abs(FV_master_set$Duration[FV_master_set$Trial_Type==4])

FV_Duration_SPUN_norm <- rnorm(0.25,mean=mean(FV_Duration_SPUN, na.rm=TRUE), sd=sd(FV_Duration_SPUN, na.rm=TRUE))
FV_Duration_CONTROL_norm <- rnorm(0.25,mean=mean(FV_Duration_CONTROL, na.rm=TRUE), sd=sd(FV_Duration_CONTROL, na.rm=TRUE))

Pltx_Duration_CONTROL_FV = c()
Pltx_Duration_SPUN_FV = c()
for (i in 1:length(FV_Duration_CONTROL)){
  Pltx_Duration_CONTROL_FV = c(Pltx_Duration_CONTROL_FV,1)
}
for (i in 1:length(FV_Duration_SPUN)){
  Pltx_Duration_SPUN_FV = c(Pltx_Duration_SPUN_FV,2)
}

for (i in 1:length(Pltx_Duration_CONTROL_FV)){
  Pltx_Duration_CONTROL_FV[i] = jitter(Pltx_Duration_CONTROL_FV[i],factor = 8)
}
for (i in 1:length(Pltx_Duration_SPUN_FV)){
  Pltx_Duration_SPUN_FV[i] = jitter(Pltx_Duration_SPUN_FV[i],factor = 3)
}

boxplot(FV_Duration_CONTROL,FV_Duration_SPUN,
#main = "Duration of Jetting Movements",
ylab = "Seconds",
at = c(1,2),
names = c("Control", "Spun"),
las = 2,
col = c("#C1FFC1","#FFAEB9"),
border = "black",
horizontal = FALSE,
notch = FALSE,
range = 0
)

points(x = Pltx_Duration_CONTROL_FV ,y = FV_Duration_CONTROL,col="black")
points(x = Pltx_Duration_SPUN_FV ,y = FV_Duration_SPUN,col="black")

```

#Avg Speed per Body Length
```{r}
FV_master_set$Trial_Type=as.factor(FV_master_set$Trial_Type)

bearing_change.lme=lme((Avg_Speed_Per_Bodylength)~Trial_Type*NewDates,random=~1|OC_ID,
                       data=FV_master_set)
bearing_change.ANOVA=Anova(bearing_change.lme,type="III")
bearing_change.ANOVA
```
```{r}
unique(FV_master_set$Trial_Type)

predict.data=data.frame(Trial_Type=as.factor(rep(unique(FV_master_set$Trial_Type),2)),NewDates=c(0,0,8,24))

predict.data$predict=predict(bearing_change.lme,newdata = predict.data,level=0)
predicted_data = predict.data

unspun_predy = c(predicted_data$predict[2],predicted_data$predict[4])
spun_predy = c(predicted_data$predict[1],predicted_data$predict[3])
u_dates_pred = c(0,24)
s_dates_pred = c(0,8)

plot(Avg_Speed_Per_Bodylength~NewDates,
     data=FV_master_set[FV_master_set$Trial_Type==4,],
     #log="y",
     ylim=range(abs(FV_master_set$Avg_Speed_Per_Bodylength)),
     pch=21,bg="red"
     )
points(Avg_Speed_Per_Bodylength~NewDates,
     data=FV_master_set[FV_master_set$Trial_Type==1,],
     pch=21,bg="blue")

lines(u_dates_pred,unspun_predy)
lines(s_dates_pred,spun_predy)
plot(bearing_change.lme, which = 1)
```
```{r}
FV_SPB_SPUN = abs(FV_master_set$Avg_Speed_Per_Bodylength[FV_master_set$Trial_Type==1])
FV_SPB_CONTROL = abs(FV_master_set$Avg_Speed_Per_Bodylength[FV_master_set$Trial_Type==4])

FV_SPB_SPUN_norm <- rnorm(0.25,mean=mean(FV_SPB_SPUN, na.rm=TRUE), sd=sd(FV_SPB_SPUN, na.rm=TRUE))
FV_SPB_CONTROL_norm <- rnorm(0.25,mean=mean(FV_SPB_CONTROL, na.rm=TRUE), sd=sd(FV_SPB_CONTROL, na.rm=TRUE))

Pltx_SPB_CONTROL_FV = c()
Pltx_SPB_SPUN_FV = c()
for (i in 1:length(FV_SPB_CONTROL)){
  Pltx_SPB_CONTROL_FV = c(Pltx_SPB_CONTROL_FV,1)
}
for (i in 1:length(FV_SPB_SPUN)){
  Pltx_SPB_SPUN_FV = c(Pltx_SPB_SPUN_FV,2)
}

for (i in 1:length(Pltx_SPB_CONTROL_FV)){
  Pltx_SPB_CONTROL_FV[i] = jitter(Pltx_SPB_CONTROL_FV[i],factor = 8)
}
for (i in 1:length(Pltx_SPB_SPUN_FV)){
  Pltx_SPB_SPUN_FV[i] = jitter(Pltx_SPB_SPUN_FV[i],factor = 3)
}

boxplot(FV_SPB_CONTROL,FV_SPB_SPUN,
#main = "Duration of Jetting Movements",
ylab = "Size-corrected speed units",
ylim = range(0,3),
at = c(1,2),
names = c("Control", "Spun"),
las = 2,
col = c("#C1FFC1","#FFAEB9"),
border = "black",
horizontal = FALSE,
notch = FALSE,
range = 0
)

points(x = Pltx_SPB_CONTROL_FV ,y = FV_SPB_CONTROL,col="black")
points(x = Pltx_SPB_SPUN_FV ,y = FV_SPB_SPUN,col="black")

```

#Avg Bearing Change
```{r}
FV_master_set$Trial_Type=as.factor(FV_master_set$Trial_Type)

bearing_change.lme=lme((Avg_Bearing_Change)~Trial_Type*NewDates,random=~1|OC_ID,
                       data=FV_master_set)
bearing_change.ANOVA=Anova(bearing_change.lme,type="III")
bearing_change.ANOVA
```
```{r}
FV_BC_SPUN =(FV_master_set$Avg_Bearing_Change[FV_master_set$Trial_Type==1])
FV_BC_CONTROL =(FV_master_set$Avg_Bearing_Change[FV_master_set$Trial_Type==4])

FV_BC_SPUN_norm <- rnorm(0.25,mean=mean(FV_BC_SPUN, na.rm=TRUE), sd=sd(FV_BC_SPUN, na.rm=TRUE))
FV_BC_CONTROL_norm <- rnorm(0.25,mean=mean(FV_BC_CONTROL, na.rm=TRUE), sd=sd(FV_BC_CONTROL, na.rm=TRUE))

Pltx_BC_CONTROL_FV = c()
Pltx_BC_SPUN_FV = c()
for (i in 1:length(FV_BC_CONTROL)){
  Pltx_BC_CONTROL_FV = c(Pltx_BC_CONTROL_FV,1)
}
for (i in 1:length(FV_BC_SPUN)){
  Pltx_BC_SPUN_FV = c(Pltx_BC_SPUN_FV,2)
}

for (i in 1:length(Pltx_BC_CONTROL_FV)){
  Pltx_BC_CONTROL_FV[i] = jitter(Pltx_BC_CONTROL_FV[i],factor = 8)
}
for (i in 1:length(Pltx_BC_SPUN_FV)){
  Pltx_BC_SPUN_FV[i] = jitter(Pltx_BC_SPUN_FV[i],factor = 3)
}


boxplot(FV_BC_CONTROL,FV_BC_SPUN,
#main = "Average BvH",
ylab = "Degrees",
ylim = range(-180,180),
at = c(1,2),
names = c("Control", "Spun"),
las = 2,
col = c("#C1FFC1","#FFAEB9"),
border = "black",
horizontal = FALSE,
notch = FALSE,
range = 0
)

points(x = Pltx_BC_CONTROL_FV ,y = FV_BC_CONTROL,col="black")
points(x = Pltx_BC_SPUN_FV ,y = FV_BC_SPUN,col="black")

```
#Avg Bearing vs heading
```{r}
FV_master_set$Trial_Type=as.factor(FV_master_set$Trial_Type)

bearing_change.lme=lme((Avg_Bearing_vs_Heading_FV)~Trial_Type*NewDates,random=~1|OC_ID,
                       data=FV_master_set)
bearing_change.ANOVA=Anova(bearing_change.lme,type="III")
bearing_change.ANOVA
```
```{r}
FV_BvH_SPUN =(FV_master_set$Avg_Bearing_vs_Heading_FV[FV_master_set$Trial_Type==1])
FV_BvH_CONTROL =(FV_master_set$Avg_Bearing_vs_Heading_FV[FV_master_set$Trial_Type==4])

FV_BvH_SPUN_norm <- rnorm(0.25,mean=mean(FV_BvH_SPUN, na.rm=TRUE), sd=sd(FV_BvH_SPUN, na.rm=TRUE))
FV_BvH_CONTROL_norm <- rnorm(0.25,mean=mean(FV_BvH_CONTROL, na.rm=TRUE), sd=sd(FV_BvH_CONTROL, na.rm=TRUE))

Pltx_BvH_CONTROL_FV = c()
Pltx_BvH_SPUN_FV = c()
for (i in 1:length(FV_BvH_CONTROL)){
  Pltx_BvH_CONTROL_FV = c(Pltx_BvH_CONTROL_FV,1)
}
for (i in 1:length(FV_BvH_SPUN)){
  Pltx_BvH_SPUN_FV = c(Pltx_BvH_SPUN_FV,2)
}

for (i in 1:length(Pltx_BvH_CONTROL_FV)){
  Pltx_BvH_CONTROL_FV[i] = jitter(Pltx_BvH_CONTROL_FV[i],factor = 8)
}
for (i in 1:length(Pltx_BvH_SPUN_FV)){
  Pltx_BvH_SPUN_FV[i] = jitter(Pltx_BvH_SPUN_FV[i],factor = 3)
}


boxplot(FV_BvH_CONTROL,FV_BvH_SPUN,
#main = "Average BvH",
xlab = "Degrees",
ylim = range(-180,180),
xaxp = c(-180, 180, 9),
at = c(1,2),
names = c("Control", "Spun"),
las = 2,
col = c("#C1FFC1","#FFAEB9"),
border = "black",
horizontal = TRUE,
notch = FALSE,
range = 0
)

points(x = FV_BvH_CONTROL ,y = Pltx_BvH_CONTROL_FV,col="black")
points(x = FV_BvH_SPUN ,y = Pltx_BvH_SPUN_FV,col="black")
abline(v = 0, col = 'black', lwd = 2)

```

#Average Bearing vs heading
```{r}
FV_master_set$Trial_Type=as.factor(FV_master_set$Trial_Type)

bearing_change.lme=lme((Avg_Bearing_vs_Heading_FV)~Trial_Type*NewDates,random=~1|OC_ID,
                       data=FV_master_set)
bearing_change.ANOVA=Anova(bearing_change.lme,type="III")
bearing_change.ANOVA
```
```{r}
FV_BvH_SPUN =(FV_master_set$Avg_Bearing_vs_Heading_FV[FV_master_set$Trial_Type==1])
FV_BvH_CONTROL =(FV_master_set$Avg_Bearing_vs_Heading_FV[FV_master_set$Trial_Type==4])

FV_BvH_SPUN_norm <- rnorm(0.25,mean=mean(FV_BvH_SPUN, na.rm=TRUE), sd=sd(FV_BvH_SPUN, na.rm=TRUE))
FV_BvH_CONTROL_norm <- rnorm(0.25,mean=mean(FV_BvH_CONTROL, na.rm=TRUE), sd=sd(FV_BvH_CONTROL, na.rm=TRUE))

Pltx_BvH_CONTROL_FV = c()
Pltx_BvH_SPUN_FV = c()
for (i in 1:length(FV_BvH_CONTROL)){
  Pltx_BvH_CONTROL_FV = c(Pltx_BvH_CONTROL_FV,1)
}
for (i in 1:length(FV_BvH_SPUN)){
  Pltx_BvH_SPUN_FV = c(Pltx_BvH_SPUN_FV,2)
}

for (i in 1:length(Pltx_BvH_CONTROL_FV)){
  Pltx_BvH_CONTROL_FV[i] = jitter(Pltx_BvH_CONTROL_FV[i],factor = 8)
}
for (i in 1:length(Pltx_BvH_SPUN_FV)){
  Pltx_BvH_SPUN_FV[i] = jitter(Pltx_BvH_SPUN_FV[i],factor = 3)
}


boxplot(FV_BvH_CONTROL,FV_BvH_SPUN,
#main = "Average BvH",
xlab = "Degrees",
ylim = range(-180,180),
xaxp = c(-180, 180, 9),
at = c(1,2),
names = c("Control", "Spun"),
las = 2,
col = c("#C1FFC1","#FFAEB9"),
border = "black",
horizontal = TRUE,
notch = FALSE,
range = 0
)

points(x = FV_BvH_CONTROL ,y = Pltx_BvH_CONTROL_FV,col="black")
points(x = FV_BvH_SPUN ,y = Pltx_BvH_SPUN_FV,col="black")
abline(v = 0, col = 'black', lwd = 2)

```

```{r}
histogram(
  FV_master_set$Avg_Bearing_vs_Heading[PA_master_set$Trial_Type==1],
  allow.multiple,
  aspect = "fill",
  xlim = c(-180,180),
  xlab = "Degrees",
  ylim = c(0,25),
  ylab = "Percent of total number of trials",
  breaks = 10,
  col = "#FFAEB9")
```
```{r}
histogram(
  FV_master_set$Avg_Bearing_vs_Heading[PA_master_set$Trial_Type==4],
  aspect = "fill",
  xlim = c(-180,180),
  xlab = "Degrees",
  ylim = c(0,25),
  ylab = "Percent of total number of trials",
  breaks = 10,
  col = "#C1FFC1")
```

```{r}
histogram(
  FV_master_set$Avg_Bearing_vs_Heading[PA_master_set$Trial_Type==1],
  allow.multiple,
  aspect = "fill",
  xlim = c(-180,180),
  xlab = "Degrees",
  ylim = c(0,25),
  ylab = "Percent of total number of trials",
  breaks = 10)
histogram(
  FV_master_set$Avg_Bearing_vs_Heading[PA_master_set$Trial_Type==4], col= "red",  xlim = c(-180,180),
  xlab = "Degrees",
  ylim = c(0,25),
  ylab = "Percent of total number of trials",
  breaks = 10, add = TRUE)
```


#Avg change in Bearing vs heading
```{r}
FV_master_set$Trial_Type=as.factor(FV_master_set$Trial_Type)

bearing_change.lme=lme((Average_Change_Bearing_vs_Heading_FV)~Trial_Type*NewDates,random=~1|OC_ID,
                       data=FV_master_set)
bearing_change.ANOVA=Anova(bearing_change.lme,type="III")
bearing_change.ANOVA
```
```{r}
FV_CBvH_SPUN =abs(FV_master_set$Average_Change_Bearing_vs_Heading_FV[FV_master_set$Trial_Type==1])
FV_CBvH_CONTROL = abs(FV_master_set$Average_Change_Bearing_vs_Heading_FV[FV_master_set$Trial_Type==4])

FV_CBvH_SPUN_norm <- rnorm(0.25,mean=mean(FV_CBvH_SPUN, na.rm=TRUE), sd=sd(FV_CBvH_SPUN, na.rm=TRUE))
FV_CBvH_CONTROL_norm <- rnorm(0.25,mean=mean(FV_CBvH_CONTROL, na.rm=TRUE), sd=sd(FV_CBvH_CONTROL, na.rm=TRUE))

Pltx_CBvH_CONTROL_FV = c()
Pltx_CBvH_SPUN_FV = c()
for (i in 1:length(FV_CBvH_CONTROL)){
  Pltx_CBvH_CONTROL_FV = c(Pltx_CBvH_CONTROL_FV,1)
}
for (i in 1:length(FV_CBvH_SPUN)){
  Pltx_CBvH_SPUN_FV = c(Pltx_CBvH_SPUN_FV,2)
}

for (i in 1:length(Pltx_CBvH_CONTROL_FV)){
  Pltx_CBvH_CONTROL_FV[i] = jitter(Pltx_CBvH_CONTROL_FV[i],factor = 8)
}
for (i in 1:length(Pltx_CBvH_SPUN_FV)){
  Pltx_CBvH_SPUN_FV[i] = jitter(Pltx_CBvH_SPUN_FV[i],factor = 3)
}


boxplot(FV_CBvH_CONTROL,FV_CBvH_SPUN,
#main = "Average BvH",
ylab = "Degrees",
at = c(1,2),
names = c("Control", "Spun"),
las = 2,
col = c("#C1FFC1","#FFAEB9"),
border = "black",
horizontal = FALSE,
notch = FALSE,
range = 0
)

points(x = Pltx_CBvH_CONTROL_FV ,y = FV_CBvH_CONTROL,col="black")
points(x = Pltx_CBvH_SPUN_FV ,y = FV_CBvH_SPUN,col="black")

```

```{r}
FV_master_set$Trial_Type=as.factor(FV_master_set$Trial_Type)

bearing_change.lme=lme((Duration)~Trial_Type*NewDates,random=~1|OC_ID,
                       data=FV_master_set)

bearing_change.ANOVA=Anova(bearing_change.lme,type="III")
bearing_change.ANOVA
#summary(bearing_change.lme)
#AIC(bearing_change.lme) 
```

```{r}
FV_Duration_SPUN = abs(FV_master_set$Duration[FV_master_set$Trial_Type==1])
FV_Duration_CONTROL = abs(FV_master_set$Duration[FV_master_set$Trial_Type==4])

FV_Duration_SPUN_norm <- rnorm(0.25,mean=mean(FV_Duration_SPUN, na.rm=TRUE), sd=sd(FV_Duration_SPUN, na.rm=TRUE))
FV_Duration_CONTROL_norm <- rnorm(0.25,mean=mean(FV_Duration_CONTROL, na.rm=TRUE), sd=sd(FV_Duration_CONTROL, na.rm=TRUE))

Pltx_Duration_CONTROL_FV = c()
Pltx_Duration_SPUN_FV = c()
for (i in 1:length(FV_Duration_CONTROL)){
  Pltx_Duration_CONTROL_FV = c(Pltx_Duration_CONTROL_FV,1)
}
for (i in 1:length(FV_Duration_SPUN)){
  Pltx_Duration_SPUN_FV = c(Pltx_Duration_SPUN_FV,2)
}

for (i in 1:length(Pltx_Duration_CONTROL_FV)){
  Pltx_Duration_CONTROL_FV[i] = jitter(Pltx_Duration_CONTROL_FV[i],factor = 8)
}
for (i in 1:length(Pltx_Duration_SPUN_FV)){
  Pltx_Duration_SPUN_FV[i] = jitter(Pltx_Duration_SPUN_FV[i],factor = 3)
}

boxplot(FV_Duration_CONTROL,FV_Duration_SPUN,
#main = "Duration of Jetting Movements",
ylab = "Seconds",
at = c(1,2),
names = c("Control", "Spun"),
las = 2,
col = c("#C1FFC1","#FFAEB9"),
border = "black",
horizontal = FALSE,
notch = FALSE,
range = 0
)

points(x = Pltx_Duration_CONTROL_FV ,y = FV_Duration_CONTROL,col="black")
points(x = Pltx_Duration_SPUN_FV ,y = FV_Duration_SPUN,col="black")

```


#CRAB CATCHING SUCCESS Analysis
```{r}
# Using Chi Square test
##Remove trials where video was lost

TTF = c()
CCF = c()
for (i in 1:length(Trial_type_log$Trial.Type)){
  if (Trial_type_log$Crab.Caught.[i] == "0" | Trial_type_log$Crab.Caught.[i] == "1"){
    TTF = c(TTF,Trial_type_log$Trial.Type[i])
    CCF = c(CCF,Trial_type_log$Crab.Caught.[i])
  }
}

crab_caught.tab = table(TTF,CCF)
crab_caught.tab
crab_caught.chi=chisq.test(crab_caught.tab)
crab_caught.chi

```

```{r}
Trial_type_log$Trial.Type=as.factor(Trial_type_log$Trial.Type)
Trial_type_log$Crab.Caught.=as.factor(Trial_type_log$Crab.Caught.)
dates.ex=strptime(Trial_type_log$Date,"%m_%d")
Cor_Dates = difftime(dates.ex,min(dates.ex),units="day")

catch.lme = glmer(Crab.Caught. ~ Trial.Type * Cor_Dates + (1 | OC_ID), data = Trial_type_log, family = binomial)

catch.ANOVA=Anova(bearing_change.lme,type="III")
catch.ANOVA
```

#Porportion of sucesses to failures boxplot
```{r}
treatment_success = 0
treatment_fail = 0
control_success = 0
control_fail = 0

for (i in 1:length(Trial_type_log$Crab.Caught.)){
  if (Trial_type_log$Trial.Type[i] == 1){
    if (Trial_type_log$Crab.Caught.[i] == 1){
      treatment_success = treatment_success + 1
    }
    else if (Trial_type_log$Crab.Caught.[i] == 0){
      treatment_fail = treatment_fail + 1
    }
  }
  else if (Trial_type_log$Trial.Type[i] == 4){
    if (Trial_type_log$Crab.Caught.[i] == 1){
      control_success = control_success + 1
    }
    else if (Trial_type_log$Crab.Caught.[i] == 0){
      control_fail = control_fail + 1
    }
  }
}

print(treatment_success)
print(treatment_fail)
print(control_success)
print(control_fail)

SF_ratio = read.table(text ="Control Spun
1 22 6 
2 165 41 ", header= TRUE)

barplot(as.matrix(SF_ratio),
        ylab = "Occurances",
        ylim = range(0,200),
        col=c("#E74C3C","#27AE60"))

legend(x = "topright",
       legend = c("Success","Failure"), 
       col = c("#E74C3C","#27AE60"),
       fill = 3:2,
       cex = 0.75)

```




##Power Analysis
```{r}
library(compute.es)
library(pwr)
```

```{r}
c_n = 0
t_n = 0

for (i in 1:length(FV_master_set$Trial_Type)){
  if (FV_master_set$Trial_Type[i] == 4){
    c_n = c_n + 1
  }
  else if (FV_master_set$Trial_Type[i] == 1){
    t_n = t_n + 1
  }
}
```

```{r}
 control.mean= mean(FV_master_set$Duration[FV_master_set$Trial_Type==4])
 control.sd= sd(FV_master_set$Duration[FV_master_set$Trial_Type==4])
 control.n = c_n
 treat.mean= mean(FV_master_set$Duration[FV_master_set$Trial_Type==1])
 treat.sd= sd(FV_master_set$Duration[FV_master_set$Trial_Type==1])
 treat.n= t_n  
```

```{r}
 eff=mes(treat.mean,control.mean,treat.sd,control.sd,treat.n,control.n)
```

```{r}
pwr.t.test(n= 172, d= -0.33, sig.level=0.05,power=NULL,type="paired",alternative="less")
```


###
#Finding means
###
#Full video: Avg Speed per Body Length means: Spun and Unspun
```{r}
#FV avgspeedpbl

U_AVGS = c()
S_AVGS = c()

for (ro in 1:length(FV_master_set$Avg_Speed_Per_Bodylength)){
  if (FV_master_set$Trial_Type[ro] == "1"){
    S_AVGS = c(S_AVGS, FV_master_set$Avg_Speed_Per_Bodylength[ro])
  }
  else if (FV_master_set$Trial_Type[ro] == "4"){
    U_AVGS = c(U_AVGS, FV_master_set$Avg_Speed_Per_Bodylength[ro])
  }
}

U_mean = mean(U_AVGS)
S_mean = mean(S_AVGS)

print(paste0("Unspun Average Speed per Bodylength: ",U_mean," Spun Average Speed per Bodylength: ",S_mean))
```
#Full video: Avg Bearing Heading Diff
```{r}

U_AVGS = c()
S_AVGS = c()

for (ro in 1:length(FV_master_set$Avg_Bearing_vs_Heading_FV)){
  if (FV_master_set$Trial_Type[ro] == "1"){
    S_AVGS = c(S_AVGS, FV_master_set$Avg_Bearing_vs_Heading_FV[ro])
  }
  else if (FV_master_set$Trial_Type[ro] == "4"){
    U_AVGS = c(U_AVGS, FV_master_set$Avg_Bearing_vs_Heading_FV[ro])
  }
}

U_mean = mean(U_AVGS)
S_mean = mean(S_AVGS)

print(paste0("Unspun Average BvH: ",U_mean," Spun Average BvH: ",S_mean))
print(U_mean - S_mean)
```

#PA: Duration Jetting
```{r}

U_AVGS = c()
S_AVGS = c()

for (ro in 1:length(PA_master_set$Duration)){
  if (PA_master_set$Trial_Type[ro] == "1"){
    S_AVGS = c(S_AVGS, PA_master_set$Duration[ro])
  }
  else if (PA_master_set$Trial_Type[ro] == "4"){
    U_AVGS = c(U_AVGS, PA_master_set$Duration[ro])
  }
}

U_mean = mean(U_AVGS)
S_mean = mean(S_AVGS)

print(paste0("Unspun Duration: ",U_mean," Spun Duration: ",S_mean))
print(U_mean - S_mean)
```

